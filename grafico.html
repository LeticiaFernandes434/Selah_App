<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Selah - Estado Emocional</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

 <!-- Fonte e Bootstrap -->
  <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
  /* seu CSS (mantive igual) */
  :root { --fundo:#E8EFF9; --texto:#1c1c1e; --card:#ffffff; --azul-pastel:#849BCD; }
  body {
    background: linear-gradient(to bottom right, #b7c7e3, #9cb3d9, #7f9ccc, #647fb8, #4a639e);
    font-family: "Poppins", sans-serif;
    color: var(--texto);
    margin: 0;
    padding: 0;
    padding-top: 70px;
  }
  header { text-align: center; padding: 40px 10px 10px; }
  h1 { font-weight: 600; font-size: 22px; margin-bottom: 8px; }
  .abas { display:flex; justify-content:center; margin:20px 0; }
  .aba { background:#D7DEEE; border:none; padding:8px 16px; margin:0 4px; border-radius:10px; font-weight:500; cursor:pointer; transition:background .2s; }
  .aba.ativa { background-color:var(--azul-pastel); color:white; }
  .container { max-width:850px; margin:0 auto; padding:0 20px 40px; }
  .card { background-color:var(--card); border-radius:20px; box-shadow:0 4px 12px rgba(0,0,0,0.06); padding:20px; margin-bottom:20px; }
  .chart-title { font-size:16px; font-weight:500; margin-bottom:10px; }
  canvas { width:100%; height:320px; }
  .resumo { text-align:center; padding:20px; background-color:#fff; border-radius:16px; box-shadow:0 4px 12px rgba(0,0,0,0.05); }
  .resumo p { margin:5px 0; font-size:16px; }
  .reflexao { background-color:#fff; border-radius:16px; padding:20px; margin-top:20px; box-shadow:0 4px 12px rgba(0,0,0,0.05); }
  .reflexao h3 { font-weight:600; margin-bottom:10px; }
  .reflexao p { margin-bottom:10px; color:#333; }
  .btn-nav { background: transparent; border: 2px solid rgba(43,46,117,0.12); border-radius: 10px; color: var(--texto); padding:6px 10px; }
</style>
</head>
<body>
    <!-- Navbar Selah -->
<nav class="navbar navbar-expand-lg navbar-light fixed-top" style="
  background: rgba(255, 255, 255, 0.6);
  backdrop-filter: blur(12px);
  box-shadow: 0 2px 12px rgba(0,0,0,0.08);
  font-family: 'Cinzel Decorative', serif;
">
  <div class="container-fluid px-4">
    <a class="navbar-brand fw-bold" href="index.html" style="color:#2b2e75; font-size:1.4rem;">
      Selah
    </a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navSelah" aria-controls="navSelah" aria-expanded="false" aria-label="Alternar navega√ß√£o">
      <span class="navbar-toggler-icon"></span>
    </button>

   
    <div class="collapse navbar-collapse justify-content-center" id="navSelah">
  <ul class="navbar-nav mb-2 mb-lg-0 gap-3">
    <li class="nav-item"><a class="nav-link" href="in√≠cio.html">In√≠cio</a></li>
    <li class="nav-item"><a class="nav-link" href="equipe.html">Equipe</a></li>
    <li class="nav-item"><a class="nav-link" href="humor.html">Humor</a></li>
    <li class="nav-item"><a class="nav-link" href="calendario.html">Calend√°rio</a></li>
    <li class="nav-item"><a class="nav-link" href="grafico.html">Gr√°fico</a></li>
    <li class="nav-item"><a class="nav-link" href="dicas.html">Dicas</a></li>
    <li class="nav-item"><a class="nav-link" href="suporte.html">Suporte</a></li>
  </ul>
</div>
</nav>
<header>
    <h1>Seu Estado Emocional</h1>
    <p>Um olhar gentil sobre como voc√™ tem se sentido</p>
</header>

<div class="abas">
    <button class="aba ativa" onclick="mudarAba('semana')">Sua semana</button>
    <button class="aba" onclick="mudarAba('mes')">M√™s</button>
    <button class="aba" onclick="mudarAba('seisMeses')">√∫ltimos 6 meses</button>
    <button class="aba" onclick="mudarAba('ano')">Ano</button>
</div>

<div class="container">
    <div class="card">
        <div class="chart-title">Gr√°fico Emocional</div>
        <canvas id="graficoEmocional"></canvas>
    </div>

    <div class="resumo" id="resumo"></div>

    <div class="reflexao">
        <h3>Reflex√£o da Semana üí≠</h3>
        <p id="textoReflexao">Voc√™ tem se mantido equilibrado entre emo√ß√µes leves e intensas. Continue observando seus sentimentos com gentileza.</p>

        <h3>Perguntinhas para pensar üïäÔ∏è</h3>
        <p>üí≠ O que mais influenciou seus sentimentos nesta semana?</p>
        <p>üí¨ H√° algo que tem te trazido conforto ou leveza?</p>
        <p>ü§ù Com quem voc√™ tem compartilhado suas emo√ß√µes?</p>
    </div>
</div>

<script>
const STORAGE_KEY = 'registrosSelah';

function getRegistros() {
    return JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
}

let periodoAtual = "semana";
const ctx = document.getElementById("graficoEmocional").getContext("2d");
let grafico;

function criarGrafico(tipo) {
    const registros = getRegistros();
    if (!registros.length) {
        document.getElementById("resumo").innerHTML = "<p>Nenhum dado registrado ainda üí¨</p>";
        if (grafico) grafico.destroy();
        return;
    }

    const emocaoCores = {};
    registros.forEach(r => emocaoCores[r.emocao] = r.cor || "#9ad1c9");

    if (grafico) grafico.destroy();

    const emocaoLabels = [...new Set(registros.map(r => r.emocao))];
    const labelsDias = [...new Set(registros.map(r => r.data))];

    if (tipo === "doughnut") {
        const totais = emocaoLabels.map(e => registros.filter(r => r.emocao === e).length);
        grafico = new Chart(ctx, {
            type: "doughnut",
            data: {
                labels: emocaoLabels,
                datasets: [{
                    data: totais,
                    backgroundColor: emocaoLabels.map(e => emocaoCores[e]),
                    borderWidth: 2,
                    borderColor: "#fff"
                }]
            },
            options: { plugins: { legend: { position: "bottom" }}, cutout: "70%" }
        });
    } else if (tipo === "bar") {
        const totais = emocaoLabels.map(e => registros.filter(r => r.emocao === e).length);
        grafico = new Chart(ctx, {
            type: "bar",
            data: {
                labels: emocaoLabels,
                datasets: [{
                    data: totais,
                    backgroundColor: emocaoLabels.map(e => emocaoCores[e]),
                    borderRadius: 8
                }]
            },
            options: { plugins: { legend: { display: false }}, scales: { y: { beginAtZero: true } } }
        });
    } else {
        const datasets = emocaoLabels.map(e => ({
            label: e,
            data: labelsDias.map(d => {
                const reg = registros.find(r => r.data === d && r.emocao === e);
                return reg ? 2 : 0;
            }),
            borderColor: emocaoCores[e],
            backgroundColor: emocaoCores[e] + "44",
            fill: false,
            tension: 0.4,
            pointRadius: 5
        }));

        grafico = new Chart(ctx, {
            type: "line",
            data: { labels: labelsDias, datasets },
            options: {
                plugins: { legend: { position: "bottom" }},
                scales: { y: { display: false } }
            }
        });
    }

    atualizarResumo(registros);
}

function mudarAba(aba) {
    periodoAtual = aba;
    document.querySelectorAll(".aba").forEach(el => el.classList.remove("ativa"));
    document.querySelector(`.aba[onclick="mudarAba('${aba}')"]`).classList.add("ativa");

    if (aba === "semana") criarGrafico("line");
    else if (aba === "mes") criarGrafico("bar");
    else if (aba === "ano") criarGrafico("doughnut");
    else criarGrafico("line");
}

function atualizarResumo(registros) {
    const resumoDiv = document.getElementById("resumo");
    const total = registros.length;
    const contagem = {};
    registros.forEach(r => contagem[r.emocao] = (contagem[r.emocao] || 0) + 1);
    const maisSentida = Object.keys(contagem).reduce((a, b) => contagem[a] > contagem[b] ? a : b);

    resumoDiv.innerHTML = `
        <p>üíó Emo√ß√£o mais sentida: <strong>${maisSentida}</strong></p>
        <p>üìà Total de registros: <strong>${total}</strong></p>
    `;
}

criarGrafico("line");
</script>

<!-- ADICIONE O BOOTSTRAP JS AQUI (resolver√° o menu mobile) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
